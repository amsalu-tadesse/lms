{% extends "sBase.html.twig" %}
{% block stylesheet %}
	<link rel="stylesheet" href="{{asset('assets/plugins/bootstrap-tabs/dist/jquery.bs4-scrolling-tabs.min.css')}}">
	<style>
		.card-header button {
			text-decoration: none;
		}
		p.meta{
			border-bottom: 1px solid #45698152;
			font-size: 15px;
			opacity: .9;
			padding-bottom: 10px;
		}

		p.message {
    		padding: 0px 24px;
			font-size: 15px;
		}

		.question{
			border-left: 3px solid blue;
		    border-radius: 6px;	
		}

		.answer{
			margin-left: 80px;
			margin-right: 1rem !important;
			border-left: 4px solid #1c4964;
		}

		.question-teacher{
			border-left: 3px solid #1b4964;
		    border-radius: 6px;
		}

		.qadata{
			float:right;
			color:black!important;
		}

		textarea{
			resize: none;
		}
		span.quadata{
			color: black!important;
		}
	</style>
{% endblock %}
{% block body %}
	<div class="container-fluid mt-3" style="min-height: 490px" ;>
		<div class="row mt-2">
		{% include "course/desc.html.twig" %}
		</div>
	</div>
{% endblock %}
{% block javascript %}
	<script src="{{asset('assets/plugins/bootstrap-tabs/dist/jquery.bs4-scrolling-tabs.min.js')}}"></script>
	<script>
		var loadControl = {
			start: 0,
			end: 0,
			round: 1,
			more: true,
		}
		$("#loadMore").on("click",function(e){	
			e.preventDefault();
			id = $(this).attr("parameter");
			loadControl.start = loadControl.round * 10;
			loadControl.end = loadControl.start+10;
			if(loadControl.more){
				$.ajax({
					url: '{{path("question_answer_load_more")}}',
					data:{start:loadControl.start, end:loadControl.end, course:id },
					success: function(data){
						if(data.length == 0)
						{
							loadControl.more = false;
						}

						$.each(data, function(i, question) {
							if(question.student != null)
							{
								var mainContainer = $('<div class="card bg-white mt-2 mx-3 question">'+
												'</div>');
								var container = $('<div class="card-body"></div>');

								var html = $('<p class="meta"><span class="qadata">'
											+question.date+'</span>'+question.student
											+'</p><p class="message">'+question.question+'</p>');
								container.append(html);
								mainContainer.append(container);
								$(".comments").append(mainContainer);
							}
							else if(question.instructor != null)
							{
								var mainContainer = $('<div class="card bg-white mt-2 mx-3 question-teacher">'+
												'</div>');
								var container = $('<div class="card-body"></div>');

								var html = $('<p class="meta"><span class="qadata">'
											+question.date+'</span>'+question.student
											+'</p><p class="message">'+question.question+'</p>');
								container.append(html);
								mainContainer.append(container);
								$(".comments").append(mainContainer);
							}

							if(question.answer != null)
								{
									var mainContainer = $('<div class="card bg-white mt-2 answer"></div>');
									var container = $('<div class="card-body"></div>');

									var html = $('<p class="meta"><span class="qadata">'
												+question.date+'</span>'+question.instructor
												+'</p><p class="message">'+question.answer+'</p>');
									container.append(html);
									mainContainer.append(container);
									$(".comments").append(mainContainer);
								}
						});
					},
					error: function(data){
						console.log("lksjdf");
					}
				});
			}	
		});
	</script>
{% endblock %}
{% block nav %}
	<a class="nav-item nav-item-temp btn btn-primary btn-sm" style="color:white" href="{{ path('app_login') }}">
		{% trans %}Sign In{% endtrans %}
	</a>
{% endblock %}
